# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill= guide_colorbar(barwidth=8))
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700), ) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"), scale = 0.9, label_fontface = "plain")
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none"))
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700), ) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"), scale = 0.9, label_fontface = "plain")
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700), ) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"), scale = 0.9, label_fontface = "plain")
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700))
leg <- get_legend(temp)
plot_grid(p1, p2, NULL, leg, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain", nrow = 2)
}
# Test.
map_fun(oa_compare_sf)
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700)) + theme(legend.position = "bottom")
leg <- get_legend(temp)
plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain"))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700)) + theme(legend.position = "bottom")
leg <- get_legend(temp)
plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
}
# Test.
map_fun(oa_compare_sf)
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700)) + theme(legend.position = "bottom")
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0,1))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700)) + theme(legend.position = "bottom")
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0,2))
}
# Test.
map_fun(oa_compare_sf)
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.2))
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) + geom_sf(aes(fill = count)) + scale_fill_viridis_c(limits = c(0,1700)) + theme(legend.position = "bottom")
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.2))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill= guide_colorbar(barheight=20))
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.2))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill= guide_colorbar(barwidth=10))
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.2))
}
# Test.
map_fun(oa_compare_sf)
?guides
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.2))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.1))
}
# Test.
map_fun(oa_compare_sf)
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(1,0.5))
}
# Test.
map_fun(oa_compare_sf)
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(100,1))
}
# Test.
map_fun(oa_compare_sf)
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 0.5)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Test.
temp <- map_fun(oa_compare_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 12, width = 6, unit = "cm")
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 12, unit = "cm")
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Test.
temp <- map_fun(oa_compare_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
lsoa_compare_all_sf <- lsoa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
# Plot and save LSOA.
temp <- map_fun(lsoa_compare_sf)
# Plot and save OA.
temp <- map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Plot and save LSOA.
temp <- map_fun(lsoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_lsoa.png", height = 24, width = 24, unit = "cm")
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
# scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
# theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save LSOA.
temp <- map_fun(lsoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_lsoa.png", height = 24, width = 24, unit = "cm")
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
# scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
# scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
# scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save LSOA.
temp <- map_fun(lsoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_lsoa.png", height = 24, width = 24, unit = "cm")
# Map function.
map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = count), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
