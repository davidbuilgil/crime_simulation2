wd_agg <- bind_rows(wd_agg, wd_agg_all)
# Bind togethe with main comparison dataset.
oa_compare_df <- oa_compare_df %>%
select(-unit_type) %>%
full_join(oa_agg, by = c("crime_type", "unit")) %>%
replace(is.na(.), 0)
lsoa_compare_df <- lsoa_compare_df %>%
full_join(lsoa_agg, by = c("crime_type", "unit")) %>%
replace(is.na(.), 0)
msoa_compare_df <- msoa_compare_df %>%
full_join(msoa_agg, by = c("crime_type", "unit")) %>%
replace(is.na(.), 0)
ward_compare_df <- ward_compare_df %>%
full_join(wd_agg, by = c("crime_type", "unit"))
# Map comparisons 14.05.20.
# Filter for all crimes and make spatial again.
oa_compare_all_sf <- oa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")]
# Map comparisons 14.05.20.
# Filter for all crimes and make spatial again.
oa_compare_all_sf <- oa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
msoa_compare_all_sf <- msoa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
View(oa_compare_all_sf)
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
scale_fill_viridis_c(limits = c(0,1700)) +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "none")
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"), scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"), scale = 0.9, label_fontface = "plain")
# plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
plot_maps
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"), scale = 0.9, label_fontface = "plain")
# plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c() +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"), scale = 0.9, label_fontface = "plain")
# plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
plot_maps <-   plot_grid(p1, p2, labels = c("All crimes","Crimes known to police"), scale = 0.9, label_fontface = "plain")
# plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1650)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1650)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1650)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1650)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
max(oa_compare_all_sf$all_crimes)
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated crime","Police recorded crime"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crime","Crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
msoa_compare_all_sf <- msoa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
# Map function.
msoa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
# scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
# scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
# scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crime","Crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- msoa_map_fun(msoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_msoa.png", height = 24, width = 24, unit = "cm")
# Map function.
msoa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,4000)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,4000)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,4000)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crime","Crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- msoa_map_fun(msoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_msoa.png", height = 24, width = 24, unit = "cm")
# Map function.
msoa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10000)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10000)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,10000)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crime","Crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- msoa_map_fun(msoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_msoa.png", height = 24, width = 24, unit = "cm")
max(msoa_compare_all_sf$all_crimes)
# Map function.
msoa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10200)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10200)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,10200)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("All crime","Crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- msoa_map_fun(msoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_msoa.png", height = 24, width = 24, unit = "cm")
oa_compare_all_sf <- oa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
# Map function.
oa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,1700)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,1700)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated all crime","Simulated crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- oa_map_fun(oa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_oa.png", height = 24, width = 24, unit = "cm")
# MSOA ===
# Filter for all crimes and make spatial again.
msoa_compare_all_sf <- msoa_compare_df %>%
filter(crime_type == "all_crimes") %>%
st_as_sf(sf_column_name = "geometry")
# Map function.
msoa_map_fun <- function(x){
p1 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = all_crimes), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10200)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
p2 <- ggplot(data = x) +
geom_sf(mapping = aes(fill = known), colour = "transparent") +
theme_minimal() +
scale_fill_viridis_c(limits = c(0,10200)) +
labs(fill = "") +
theme(legend.position = "none") +
guides(fill = guide_colorbar(barwidth=10, barheight = 1)) + labs(fill = NULL)
temp <- ggplot(data = x) +
geom_sf(aes(fill = count)) +
scale_fill_viridis_c(limits = c(0,10200)) +
theme(legend.position = "bottom") +
guides(fill = guide_colorbar(barwidth=20, barheight = 1)) + labs(fill = NULL)
leg <- get_legend(temp)
plot_maps <-   plot_grid(p1, p2, labels = c("Simulated all crime","Simulated crime known to police"),
scale = 0.9, label_fontface = "plain")
plot_grid(plot_maps, leg, nrow = 2, rel_heights = c(10,1))
}
# Plot and save OA.
temp <- msoa_map_fun(msoa_compare_all_sf)
ggsave(plot = temp, filename = "visuals/map_comaprison_msoa.png", height = 24, width = 24, unit = "cm")
